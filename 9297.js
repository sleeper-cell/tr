"use strict";(self.webpackChunkbrowser_extension_wallet=self.webpackChunkbrowser_extension_wallet||[]).push([["9297"],{99795:function(e,t,r){r.d(t,{u:()=>useSetTheme});var n=r(43057),a=r(8968),useSetTheme=function(){var e=(0,n.TL)();return{setColorMode:function(t){e(a.x.actions.setUIColorMode(t))}}}},35411:function(e,t,r){r.d(t,{b:()=>useIsPopupView});var n=r(67294);function getPopupDimensions(){var e=document.documentElement;return{width:parseInt(e.style.width,10)||0,height:parseInt(e.style.height,10)||0}}function _array_like_to_array(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _array_with_holes(e){if(Array.isArray(e))return e}function _iterable_to_array_limit(e,t){var r,n,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],l=!0,i=!1;try{for(a=a.call(e);!(l=(r=a.next()).done)&&(o.push(r.value),!t||o.length!==t);l=!0);}catch(e){i=!0,n=e}finally{try{l||null==a.return||a.return()}finally{if(i)throw n}}return o}}function _non_iterable_rest(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _sliced_to_array(e,t){return _array_with_holes(e)||_iterable_to_array_limit(e,t)||_unsupported_iterable_to_array(e,t)||_non_iterable_rest()}function _unsupported_iterable_to_array(e,t){if(e){if("string"==typeof e)return _array_like_to_array(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _array_like_to_array(e,t)}}var useIsPopupView=function(){var e=_sliced_to_array((0,n.useState)(function(){var e=getPopupDimensions(),t=e.width,r=e.height;return window.innerWidth===t&&window.innerHeight===r}),2),t=e[0],r=e[1];return(0,n.useEffect)(function(){var checkIsPopupView=function(){var e=getPopupDimensions(),t=e.width,n=e.height;r(window.innerWidth===t&&window.innerHeight===n)};return window.addEventListener("resize",checkIsPopupView),function(){return window.removeEventListener("resize",checkIsPopupView)}},[]),t}},95674:function(e,t,r){r.r(t),r.d(t,{default:()=>unlock});var n=r(3959),a=r(67911),o=r(65878),l=r(18767),i=r(87889),u=r(96492),c=r(69310),s=r(45653),_=r(35670),f=r(29884),p=r(43057),d=r(40772),m=r(71548),y=r(67294),h=r(86896),b=r(89250),v=r(68286),w=r(64932),E=r(37354),k=r(19568),g=r(99795),S=r(78729),A=r(5131),N=r(15244),x=r(97509),T=r(48990),C=r(77619),R=r(33010),M=r(90980),L=r(67294);function _array_like_to_array(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _array_with_holes(e){if(Array.isArray(e))return e}function asyncGeneratorStep(e,t,r,n,a,o,l){try{var i=e[o](l),u=i.value}catch(e){r(e);return}i.done?t(u):Promise.resolve(u).then(n,a)}function _async_to_generator(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function _next(e){asyncGeneratorStep(o,n,a,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(o,n,a,_next,_throw,"throw",e)}_next(void 0)})}}function _iterable_to_array_limit(e,t){var r,n,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],l=!0,i=!1;try{for(a=a.call(e);!(l=(r=a.next()).done)&&(o.push(r.value),!t||o.length!==t);l=!0);}catch(e){i=!0,n=e}finally{try{l||null==a.return||a.return()}finally{if(i)throw n}}return o}}function _non_iterable_rest(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _sliced_to_array(e,t){return _array_with_holes(e)||_iterable_to_array_limit(e,t)||_unsupported_iterable_to_array(e,t)||_non_iterable_rest()}function _unsupported_iterable_to_array(e,t){if(e){if("string"==typeof e)return _array_like_to_array(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _array_like_to_array(e,t)}}function _ts_generator(e,t){var r,n,a,o,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function verb(e){return function(t){return step([e,t])}}function step(o){if(r)throw TypeError("Generator is already executing.");for(;l;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,n=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!(a=(a=l.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){l=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){l.label=o[1];break}if(6===o[0]&&l.label<a[1]){l.label=a[1],a=o;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(o);break}a[2]&&l.ops.pop(),l.trys.pop();continue}o=t.call(e,l)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}var ModalResetWallet=function(e){var t=e.opened,r=e.onClose,l=e.onResetting,u=(0,g.u)().setColorMode,p=(0,h.Z)().formatMessage,d=_sliced_to_array((0,y.useState)(!1),2),m=d[0],b=d[1],O=(0,k.z)().trackAnalytics,U=(0,y.useCallback)(_async_to_generator(function(){var e;return _ts_generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),b(!0),l(),[4,x.Tl.emit(f.Z.RESET)];case 1:return t.sent(),u(C.R.SYSTEM),O({event:T.ih.RESET_WALLET,props:{pageViewSource:T.pG.UNLOCK}}),(0,R.YQ)(n.Z.ONBOARDING),window.close(),[3,3];case 2:return e=t.sent(),M.Z.error(e),[3,3];case 3:return[2]}})}),[u]);return m?L.createElement(i.M,{direction:c.k.COLUMN},L.createElement("div",null,L.createElement(w.Y,null)),L.createElement("div",{className:"pt-20 pb-8"},L.createElement(s.x,{type:_.Xi.SUBTITLE},p({id:"modal-reset-wallet.loading"}))),L.createElement("div",{className:"pb-28"},L.createElement(N.$,{size:S.m.XLARGE}))):L.createElement(A.u,{opened:t,onClose:r,title:p({id:"modal-reset-wallet.modal.title",defaultMessage:"Reset your wallet"})},L.createElement(i.M,{direction:c.k.COLUMN},L.createElement("div",null,L.createElement(v._,null)),L.createElement("div",{className:"py-2"},L.createElement(s.x,{type:_.Xi.HEADER}," ",p({id:"modal-reset-wallet.title"}))),L.createElement("div",null,p({id:"modal-reset-wallet.description"},{brandName:E.TY.BRAND_NAME,seedPhraseName:E.TY.SEED_PHRASE_NAME,li:function(e){return L.createElement("div",{className:"pb-2"},L.createElement(s.x,{weight:_.kx.NORMAL,theme:_.W5.SECONDARY},e))},b:function(e){return L.createElement("strong",{className:"font-medium"},e)}})),L.createElement("div",{className:"pt-3 pb-5 w-full"},L.createElement(a.z,{theme:o.jM.DANGER,onClick:U},p({id:"modal-reset-wallet.btn-i-understand"}))),L.createElement("div",{className:" w-full"},L.createElement(a.z,{theme:o.jM.TRANSPARENT,onClick:r},L.createElement(s.x,{type:_.Xi.TITLE,theme:_.W5.BRAND},p({id:"generic.cancel"}))))))},O=r(20763),U=r(1842),I=r(3105),D=r(23957),P=r(20218),G=r(35411),j=r(72462),B=r(67294);function unlock_array_like_to_array(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function unlock_array_with_holes(e){if(Array.isArray(e))return e}function unlock_asyncGeneratorStep(e,t,r,n,a,o,l){try{var i=e[o](l),u=i.value}catch(e){r(e);return}i.done?t(u):Promise.resolve(u).then(n,a)}function unlock_async_to_generator(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function _next(e){unlock_asyncGeneratorStep(o,n,a,_next,_throw,"next",e)}function _throw(e){unlock_asyncGeneratorStep(o,n,a,_next,_throw,"throw",e)}_next(void 0)})}}function unlock_iterable_to_array_limit(e,t){var r,n,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],l=!0,i=!1;try{for(a=a.call(e);!(l=(r=a.next()).done)&&(o.push(r.value),!t||o.length!==t);l=!0);}catch(e){i=!0,n=e}finally{try{l||null==a.return||a.return()}finally{if(i)throw n}}return o}}function unlock_non_iterable_rest(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function unlock_sliced_to_array(e,t){return unlock_array_with_holes(e)||unlock_iterable_to_array_limit(e,t)||unlock_unsupported_iterable_to_array(e,t)||unlock_non_iterable_rest()}function unlock_unsupported_iterable_to_array(e,t){if(e){if("string"==typeof e)return unlock_array_like_to_array(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return unlock_array_like_to_array(e,t)}}function unlock_ts_generator(e,t){var r,n,a,o,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function verb(e){return function(t){return step([e,t])}}function step(o){if(r)throw TypeError("Generator is already executing.");for(;l;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,n=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!(a=(a=l.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){l=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){l.label=o[1];break}if(6===o[0]&&l.label<a[1]){l.label=a[1],a=o;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(o);break}a[2]&&l.ops.pop(),l.trys.pop();continue}o=t.call(e,l)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}let unlock=function(){(0,O.d)({event:T.pG.UNLOCK,props:null});var e,t,r,v=(0,h.Z)().formatMessage,w=(0,b.s0)(),E=(0,b.TH)(),g=(0,P.n)(),S=(0,k.z)().trackAnalytics,A=unlock_sliced_to_array((0,y.useState)(""),2),N=A[0],C=A[1],L=unlock_sliced_to_array((0,y.useState)(""),2),Y=L[0],Z=L[1],z=unlock_sliced_to_array((0,y.useState)(!1),2),W=z[0],V=z[1],K=unlock_sliced_to_array((0,y.useState)(!1),2),X=K[0],H=K[1],F=unlock_sliced_to_array((0,y.useState)(!1),2),$=F[0],Q=F[1],J=(0,G.b)(),q=unlock_sliced_to_array((0,y.useState)(!1),2),ee=q[0],et=q[1],er=(0,p.CG)(function(e){return e.app}),en=(0,p.CG)(function(e){return e.settings.passkeyId}),ea=unlock_sliced_to_array((0,y.useState)(!1),2),eo=ea[0],el=ea[1],ei=null!=(r=new URLSearchParams(E.search).get("biometrics"))?r:"",eu=unlock_sliced_to_array((0,y.useState)(!1),2),ec=eu[0],es=eu[1];(0,y.useEffect)(function(){er.authenticated&&w(n.Z.DEFAULT,{replace:!0})},[er.authenticated,en]);var e_=(0,y.useCallback)((e=unlock_async_to_generator(function(e){var t,r,a;return unlock_ts_generator(this,function(o){switch(o.label){case 0:null==e||e.preventDefault(),H(!0),o.label=1;case 1:return o.trys.push([1,3,,4]),p.h.dispatch(d.t.actions.setAuthenticating(!0)),[4,x.Tl.emit(f.Z.AUTHENTICATE,N)];case 2:return o.sent(),r=(null==(t=E.state)?void 0:t.from)||{},S({event:T.ih.UNLOCK,props:{pageViewSource:T.pG.UNLOCK,status:"success"}}),w(r.pathname+r.search||n.Z.DEFAULT,{replace:!0}),[3,4];case 3:return a=o.sent(),p.h.dispatch(d.t.actions.setAuthenticating(!1)),S({event:T.ih.UNLOCK,props:{pageViewSource:T.pG.UNLOCK,status:"fail",error:a.message}}),"memory access out of bounds"===a.message?Z(v({id:"unlock.memory-error"})):Z(a.message),H(!1),[3,4];case 4:return[2]}})}),function(t){return e.apply(this,arguments)}),[E.state,w,N]),ef=(t=unlock_async_to_generator(function(){var e,t,r,a;return unlock_ts_generator(this,function(o){switch(o.label){case 0:if(J||g)return[2,(0,R.YQ)(n.Z.UNLOCK+"?biometrics=true")];if(ee||(et(!0),!en))return[2];o.label=1;case 1:return o.trys.push([1,5,6,7]),[4,new I.Z().login(en)];case 2:if(!(null==(e=o.sent())?void 0:e.password))return[3,4];return[4,x.Tl.emit(U.Z.GET_PASSKEY_VAULT,e.password)];case 3:o.sent(),r=(null==(t=E.state)?void 0:t.from)||{},S({event:T.ih.UNLOCK,props:{pageViewSource:T.pG.UNLOCK,status:"success"}}),w(r.pathname+r.search||n.Z.DEFAULT,{replace:!0}),o.label=4;case 4:return[3,7];case 5:return a=o.sent(),M.Z.error(a),[3,7];case 6:return et(!1),[7];case 7:return[2]}})}),function(){return t.apply(this,arguments)});return(0,y.useEffect)(function(){en&&"true"===ei&&(ec||(es(!0),et(!0),ef()))},[en,ei,ef]),B.createElement(u._z,null,!$&&B.createElement(u.xV,null,B.createElement(i.M,{direction:c.k.COLUMN},B.createElement("div",{className:"max-w-xs flex items-center flex-col"},B.createElement(j.t,null),B.createElement("div",{className:"pt-4 pb-6 text-center"},B.createElement(s.x,{type:_.Xi.TITLE}," ",v({id:"unlock.subheading"}))),B.createElement("form",{className:"flex flex-col w-full",onSubmit:e_},(!en||eo)&&B.createElement(l.C,{testid:"password-field",label:v({id:"component.input-password.placeholder"}),value:N,onChange:function(e){Z(""),C(e.target.value)},error:Y,autoFocus:!0}),B.createElement("div",{className:"pt-6 pb-4 w-full flex flex-col gap-4"},(!en||eo)&&B.createElement(a.z,{type:o.JB.SUBMIT,disabled:!N||ee,loading:X,onClick:m.G1,theme:en&&!eo?o.jM.NEUTRAL:void 0},v({id:"generic.unlock"})),en&&B.createElement(B.Fragment,null,B.createElement(a.z,{type:o.JB.BUTTON,loading:ee,theme:eo?o.jM.TRANSPARENT:void 0,disabled:X||ee,onClick:eo?function(){return el(!1)}:ef},B.createElement(s.x,{theme:eo?_.W5.BRAND:_.W5.ON_PRIMARY,type:_.Xi.BODY},B.createElement("div",{className:"flex gap-2 items-center"},v({id:"generic.unlock-biometrics",defaultMessage:"Unlock with Biometrics"}),B.createElement(D.Q,null)))),!eo&&B.createElement(a.z,{theme:o.jM.TRANSPARENT,onClick:function(){return el(!0)}},B.createElement(s.x,{theme:_.W5.BRAND,type:_.Xi.BODY},v({id:"unlock.use-password-instead",defaultMessage:"Use password instead"})))))))),B.createElement("div",{className:"flex flex-col items-center justify-end text-center w-full border-t-line border-t pt-4"},B.createElement("div",{className:"w-10/12"},B.createElement(s.x,{weight:_.kx.NORMAL,theme:_.W5.SECONDARY},v({id:"unlock.cannot-login"}))),B.createElement(a.z,{theme:o.jM.TRANSPARENT,onClick:function(){return V(!0)}},B.createElement(s.x,{theme:_.W5.BRAND,type:_.Xi.BODY},v({id:"unlock.reset-wallet"}))))),B.createElement(ModalResetWallet,{opened:W,onClose:function(){return V(!1)},onResetting:function(){return Q(!0)}}))}}}]);